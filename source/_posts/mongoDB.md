---
title: mongoDB常用命令
date: 2021-05-13 09:33:36
tags:
---

# MongoDB 命令

> 一些常用命令合集

## 增删改查

1. 建立 mongoDB 连接

```
$ mongo
```

2. 展示本机上的所有数据库

```
$ show dbs
```

3. 使用某数据库

```
$ use </*数据库名*/>
```

4. 新建数据库（**只有插入一条数据才能新建数据库**）

```
$ use </*数据库名*/>
$ db.</*集合名*/>.insert({/*数据*/})
```

5. 展示该数据库内的集合

```
$ show collections
```

6. 删除数据库

```
$ db.dropDatabase()
```

7. 删除数据库内的集合

```
$ db.</*集合名*/>.drop()
```

8. 查看集合里面的数据
   > 括号里的参数可以指定查找哪一个数据,可以传正则表达式

```
$ db.</*集合名*/>.find({/*查找关键字*/})
```

9. 清除屏幕

```
$ cls
```

10.大于，小于，大于等于，小于等于（条件）

```
大于：{$gt:...}
小于：{$lt:...}
大于等于：{$gte:...}
小于等于：{$lte:...}
```

11. 修改数据
    > $set表示只替换部分数据，没有$set 表示替换所有数据

```
$ db.</*集合名*/>.update({/*数据*/},{$set:...})
```

12. 删除数据

```
$ db.</*集合名*/>.remove({/*数据*/})
```

## 索引

> 索引能够使查询数据库变得更快

1. 创建索引

```
$ db.</*集合名*/>.ensureIndex({"/*数据*/":1})
```

2. 获取某集合的索引

```
$ db.</*集合名*/>.getIndexes()
```

3. 删除索引

```
$ db.</*集合名*/>.dropIndex({"/*数据*/":1})
```

4. 唯一索引

```
$ db.</*集合名*/>.dropIndex({"/*数据*/":1},{"unique":true})
```

## 聚合管道

1. 查询指定的字段

```
$ db.</*集合名*/>.aggregate.([
    {
        $project:{/*数据：1*/}
    }
])
```

2. 查询符合条件的数据

```
$ db.</*集合名*/>.aggregate.([
    {
        $project:{/*数据：1(数据不需要引号)*/}
    },
    {
        $match:{/*"数据名称":{$gte:100}*/}
    }
])
```

3. 将集合中的文档分组

```
$ db.</*集合名*/>.aggregate.([
    {
        $group:{_id:"/*数据名称*/",total:{/*$sum:"$price"*/}}
    }
])
```

4.表关联

```
$ db.</*集合名*/>.aggregate.([
    {
        $lookup:
        {
            from:"/*另一张表*/",
            localField:"/*关联字段*/",
            foreignField:"/*另一张表的关联字段*/",
            as:"/*关联的数据的key*/"
        }
    }
])
```

## 备份以及还原

1. 备份

```
$ mongodump -h /*host*/ -d /*name*/ -o /*directory*/
```

2. 还原

```
$mongorestore -h /*host*/ -d /*name*/ /*路径*/
```
